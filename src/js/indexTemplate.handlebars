import { parameterBuilder, fetchHelper, eventSourceHelper } from 'rest-api-support';

/**
 *
 * @export
 * @class {{{jsIdentifier apiClassName}}}
 */
export default class {{{apiClassName}}} {
  constructor({
    baseUrl = '',
    fetch,
    requestInterceptor,
    responseInterceptor,
  } = {}) {
    Object.assign(this, { baseUrl, fetch, requestInterceptor, responseInterceptor });
  }

{{#each methods}}
  /**
   * {{#if description.length}}{{{description}}}{{else}}{{name}}{{/if}}
   *
  {{#each params}}
   * @parameter { {{{type}}} } {{{name}}}: {{{description}}}
  {{/each}}
   */
  async {{{name}}}({
{{#each params}}
    {{{name}}},
{{/each}}
  }, fetchOptions) {
    // Build parameters, run request interceptors, fetch, and then run response interceptors
    const fetchArgs = parameterBuilder('{{{capMethod}}}', this.baseUrl, '{{{path}}}')
{{#each params}}      .{{{in}}}('{{{serverName}}}', {{{name}}}{{#if format}}, { {{#if format}}
        format: '{{format}}',
      {{/if}} }{{#if @last}}){{/if}}{{/if}}){{#if @last}}
      .build();{{/if}}
{{/each}}{{#if streaming}}
    return fetchHelper(this, fetchArgs, fetchOptions);
{{else}}
    return eventSourceHelper(this, fetchArgs, fetchOptions);
{{/if}}
  }

{{/each}}
}
