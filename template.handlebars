import Foundation

open class Api { 
{{#each methods}}
  open static func {{{name}}}(
  {{#each params}}
  {{{name}}}: {{{type}}},
  {{/each}}
  completion: (Error?, {{{response.type}}}) -> Void
  ) {
    // {{{method}}} {{{path}}}
  }
{{/each}}
}

{{#each objectModels}}
  open class {{{name}}}: SwaggerObject {
  {{#with schema}}
    {{#each properties}}
      public var {{{@key}}}: {{{type}}}{{#unless isRequired}}?{{/unless}}
    {{/each}}

    required public init(
    {{#each properties}}
      {{{@key}}}: {{{type}}} {{~#unless isRequired}}?=nil{{/unless}} {{~#unless @last}},{{/unless}}
    {{/each}}
    ) {
    {{#each properties}}
      self.{{{@key}}} = {{{@key}}}
    {{/each}}
    }

    public func shallowSerialize() -> Any? {
      return [
      {{#each properties}}
        "{{{specName}}}": {{{@key}}},
      {{/each}}
      ]
    }

    public static func deserialize(json: Any) -> Self {
      guard let dictionary = json as? [String: Any] else {
        fatalError("Deserialization error: expected {{{../name}}} but got \(json)")
      }
      return self.init(
      {{#each properties}}
        {{{@key}}}: {{#unless isRequired}}Optional<{{/unless}}{{{type}}}{{#unless isRequired}}>{{/unless}}.deserialize(json: dictionary["{{{specName}}}"]){{#unless @last}},{{/unless}}
      {{/each}}
      )
    }
  {{/with}}
  }

{{/each}}

{{#each enumModels}}
  public enum {{{name}}}: {{{schema.enumType}}}, SwaggerObject {
  {{#with schema}}
    {{#each values}}
      case {{{name}}} = {{{value}}}
    {{/each}}
    public func shallowSerialize() -> Any? {
      return rawValue;
    }
    public static func deserialize(json: Any) -> {{{../name}}} {
      guard let asType = json as? {{{enumType}}},
        let asEnum = {{{../name}}}(rawValue: asType) else {
        fatalError("Deserialization error: expected {{{enumType}}} but got \(json)")
      }
      return asEnum
    }
  {{/with}}
  }
{{/each}}
